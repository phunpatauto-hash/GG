<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <title>‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô - Card Shop</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #121212; color: white; margin: 0; padding: 20px; }
        .container { max-width: 600px; margin: auto; }
        .card { background: #1e1e1e; padding: 25px; border-radius: 15px; border: 1px solid #333; margin-bottom: 20px; }
        h2 { color: #ffcc00; margin-top: 0; border-bottom: 1px solid #333; padding-bottom: 10px; }
        
        /* ‡∏™‡πà‡∏ß‡∏ô‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç */
        .info-group { margin: 15px 0; }
        label { display: block; color: #888; font-size: 0.9rem; margin-bottom: 5px; }
        input { width: 100%; padding: 10px; background: #2a2a2a; border: 1px solid #444; border-radius: 5px; color: white; box-sizing: border-box; }
        input:disabled { background: #121212; color: #888; border: none; }
        
        .btn { padding: 10px 20px; border-radius: 5px; cursor: pointer; font-weight: bold; border: none; transition: 0.3s; }
        .btn-edit { background: #ffcc00; color: black; }
        .btn-save { background: #28a745; color: white; display: none; }
        
        /* ‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏û‡∏±‡∏™‡∏î‡∏∏ */
        .status-box { background: #2a2a2a; padding: 15px; border-radius: 10px; display: flex; align-items: center; gap: 15px; }
        .status-icon { font-size: 2rem; }
        .status-text { flex-grow: 1; }
        .status-badge { background: #ffcc00; color: black; padding: 2px 8px; border-radius: 4px; font-size: 0.8rem; font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <button onclick="location.href='index.html'" style="background:none; border:none; color:#888; cursor:pointer; margin-bottom:10px;">‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</button>
    
    <div class="card">
        <h2>üë§ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß</h2>
        <div class="info-group">
            <label>‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô (Username)</label>
            <input type="text" id="p-username" disabled>
        </div>
        <div class="info-group">
            <label>‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô (Password)</label>
            <input type="password" id="p-password" disabled>
        </div>
        <div style="text-align: right; margin-top: 20px;">
            <button id="btn-edit" class="btn btn-edit" onclick="enableEdit()">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
            <button id="btn-save" class="btn btn-save" onclick="saveEdit()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á</button>
        </div>
    </div>

    <div class="card">
        <h2>üì¶ ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô</h2>
        <div id="tracking-section">
            <div class="status-box">
                <div class="status-icon" id="s-icon">‚åõ</div>
                <div class="status-text">
                    <div style="font-weight: bold;">Battle Deck CT01 <span class="status-badge" id="s-badge">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</span></div>
                    <div id="s-desc" style="font-size: 0.85rem; color: #aaa; margin-top: 5px;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î...</div>
                </div>
            </div>
            <button onclick="location.href='track.html'" style="width:100%; margin-top:15px; background:none; border:1px solid #444; color:#ffcc00; padding:8px; border-radius:5px; cursor:pointer;">‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡πÅ‡∏ö‡∏ö‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</button>
        </div>
    </div>
</div>

<script>
    // 1. ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å LocalStorage
    window.onload = function() {
        // ‡∏î‡∏∂‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏µ‡πà Login ‡∏≠‡∏¢‡∏π‡πà (‡∏™‡∏°‡∏°‡∏ï‡∏¥‡∏ß‡πà‡∏≤‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏Å‡πá‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏ô Login ‡πÑ‡∏ß‡πâ‡πÉ‡∏ô 'currentUser')
        const loggedInUser = localStorage.getItem("currentUser") || "Guest";
        const userList = JSON.parse(localStorage.getItem("userList")) || [];
        
        // ‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á User ‡∏Ñ‡∏ô‡∏ô‡∏µ‡πâ‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        const userData = userList.find(u => u.username === loggedInUser) || {username: loggedInUser, password: "N/A"};
        
        document.getElementById("p-username").value = userData.username;
        document.getElementById("p-password").value = userData.password;

        // 2. ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏û‡∏±‡∏™‡∏î‡∏∏
        const orderStatus = localStorage.getItem("orderStatus") || "preparing";
        updateStatusUI(orderStatus);
    };

    function updateStatusUI(status) {
        const icon = document.getElementById("s-icon");
        const badge = document.getElementById("s-badge");
        const desc = document.getElementById("s-desc");

        if(status === "preparing") {
            icon.innerText = "üì¶";
            badge.innerText = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡∏≠‡∏á";
            desc.innerText = "‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÅ‡∏•‡∏∞‡πÅ‡∏û‡πá‡∏Ñ‡∏•‡∏á‡∏Å‡∏•‡πà‡∏≠‡∏á";
        } else if(status === "shipping") {
            icon.innerText = "üöö";
            badge.innerText = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏±‡∏î‡∏™‡πà‡∏á";
            desc.innerText = "‡∏û‡∏±‡∏™‡∏î‡∏∏‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏Ç‡∏ô‡∏™‡πà‡∏á‡πÇ‡∏î‡∏¢‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà";
        } else if(status === "delivered") {
            icon.innerText = "‚úÖ";
            badge.innerText = "‡∏™‡πà‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à";
            desc.innerText = "‡∏û‡∏±‡∏™‡∏î‡∏∏‡∏ñ‡∏∂‡∏á‡∏à‡∏∏‡∏î‡∏´‡∏°‡∏≤‡∏¢‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß";
        }
    }

    // 3. ‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
    function enableEdit() {
        document.getElementById("p-username").disabled = false;
        document.getElementById("p-password").disabled = false;
        document.getElementById("btn-edit").style.display = "none";
        document.getElementById("btn-save").style.display = "inline-block";
        document.getElementById("p-username").focus();
    }

    function saveEdit() {
        const newUser = document.getElementById("p-username").value;
        const newPass = document.getElementById("p-password").value;
        const oldUser = localStorage.getItem("currentUser");

        let userList = JSON.parse(localStorage.getItem("userList")) || [];
        
        // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô List
        const index = userList.findIndex(u => u.username === oldUser);
        if (index !== -1) {
            userList[index].username = newUser;
            userList[index].password = newPass;
            localStorage.setItem("userList", JSON.stringify(userList));
            localStorage.setItem("currentUser", newUser); // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏•‡πá‡∏≠‡∏Ñ‡∏≠‡∏¥‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏î‡πâ‡∏ß‡∏¢
            
            alert("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!");
            location.reload(); // ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏´‡∏ô‡πâ‡∏≤
        }
    }
</script>

</body>
</html>